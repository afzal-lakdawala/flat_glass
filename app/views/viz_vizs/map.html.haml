= content_for :breadcrumb do
  %ol.breadcrumb
    %li= link_to "Home", root_url
    %li= link_to @account.owner.username, user_path(@account.owner)
    %li= link_to @account.slug, user_account_path(@account.owner, @account.slug)
    %li= link_to "visualizations", user_account_viz_vizs_path(@account.owner, @account.slug)
    %li= link_to @viz_viz.title, user_account_viz_viz_path(@account.owner, @account.slug, file_id: @viz_viz.slug)
    %li.active Map
.row
  .col-sm-12
    .panel.panel-default
      .panel-heading
        %i.glyphicon.glyphicon-list-alt
        &nbsp;
        %b= @viz_viz.title
      .panel-content{style: "padding: 10px;"}
        %h4 Map columns to Chart
        #pie-mapper
          #user-variables.col-sm-4
          = debug @viz_viz.reference_map
          - @viz_viz.reference_map.each do |m|
            .col-sm-2
              %h5= m[0]
              #data-drop.takes-drop{"data-droptype" => m[1], "map_identifier" => m[0]} Drop Here
        %button.btn.btn-primary#get-pie Next &raquo;
= javascript_include_tag("/mapper")
:javascript
  DATA = [#{@viz_viz.headers}];
  URL = "/#{@account.owner.slug}/#{@account.slug}/visualizations/#{@viz_viz.slug}/put_map"

  var pm = new PieMapper;
  pm.init();

  $("#get-pie").click(function(){
      pm.mappingData();
  });
